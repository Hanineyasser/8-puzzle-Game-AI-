<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>BFS 8-Puzzle Viewer</title>
        <style>
            :root {
                /* initialize a color palette */
                --bg: #0b1020;
                --card: #0f1724;
                --play: #60a5fa;
            }
            body {
                margin: 0;
                background: linear-gradient(180deg, var(--bg), #061021);
                font-family: Inter, Segoe UI, Roboto, Arial;
                /* color for the heading and next and prev buttons */
                color: #e6eef8;
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
            }
            .top {
                margin-bottom: 16px;
            }
            .card {
                background: rgba(255, 255, 255, 0.02);
                border: 3px solid rgba(255, 255, 255, 0.04);
                padding: 18px;
                border-radius: 10px;
            }
            .board {
                width: 360px;
                height: 360px;
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            .tile {
                display: flex;
                align-items: center;
                justify-content: center;
                /* linear gradient -->mix of 2 colors*/
                background: linear-gradient(180deg, #0f2238, #0b1b2e);
                border-radius: 10px;
                font-size: 32px;
                font-weight: 700;
                color: white;
            }
            .tile.zero {
                background: transparent;
                border: 2px dashed rgba(255, 255, 255, 0.04);
                color: var(--sentence);
                font-weight: 600;
            }
            .controls {
                display: flex;
                gap: 8px;
                margin-bottom: 10px;
            }
            button {
                padding: 10px;
                border-radius: 8px;
                border: 2px solid rgba(255, 255, 255, 0.06);
                background: transparent;
                color: inherit;
            }
            button.primary {
                /* for the play button */
                background: linear-gradient(90deg, var(--play), #34d399);
                border: none;
                color: #022;
            }
            .steps-list {
                display: flex;
                flex-direction: column;
                gap: 8px;
                margin-left: 16px;
            }
            .step-thumb {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
                padding: 6px;
                border-radius: 8px;
                background: rgba(255, 255, 255, 0.01);
            }
            .layout {
                display: flex;
            }
        </style>
    </head>
    <body>
        <div class="wrap">
            <div class="top">
                    <h1>8-Puzzle Viewer</h1>
                    <div >
                        Use the controls to step through the solution
                    </div>
            </div>

            <div class="layout">
                <div class="card">
                    <div class="controls">
                        <button id="prev">◀ Prev</button>
                        <button id="next">Next ▶</button>
                        <button id="play" class="primary">Play</button>
                        <!-- for the steps -->
                        <div style="flex: 1"></div>
                        <div id="status" style="color: var(--sentence)"></div>
                    </div>
                    <div id="board" class="board"></div>
                </div>
                <div class="steps-list card" id="stepsList"></div>
            </div>
        </div>

        <script>
            // DATA placeholder will be replaced by index.py
            var DATA = {"initial": [[1, 3, 2], [4, 0, 5], [8, 7, 6]], "steps": [[[1, 3, 2], [4, 0, 5], [8, 7, 6]], [[1, 0, 2], [4, 3, 5], [8, 7, 6]], [[1, 2, 0], [4, 3, 5], [8, 7, 6]], [[1, 2, 5], [4, 3, 0], [8, 7, 6]], [[1, 2, 5], [4, 3, 6], [8, 7, 0]], [[1, 2, 5], [4, 3, 6], [8, 0, 7]], [[1, 2, 5], [4, 3, 6], [0, 8, 7]], [[1, 2, 5], [0, 3, 6], [4, 8, 7]], [[1, 2, 5], [3, 0, 6], [4, 8, 7]], [[1, 2, 5], [3, 6, 0], [4, 8, 7]], [[1, 2, 5], [3, 6, 7], [4, 8, 0]], [[1, 2, 5], [3, 6, 7], [4, 0, 8]], [[1, 2, 5], [3, 0, 7], [4, 6, 8]], [[1, 2, 5], [3, 7, 0], [4, 6, 8]], [[1, 2, 0], [3, 7, 5], [4, 6, 8]], [[1, 0, 2], [3, 7, 5], [4, 6, 8]], [[0, 1, 2], [3, 7, 5], [4, 6, 8]], [[3, 1, 2], [0, 7, 5], [4, 6, 8]], [[3, 1, 2], [4, 7, 5], [0, 6, 8]], [[3, 1, 2], [4, 7, 5], [6, 0, 8]], [[3, 1, 2], [4, 0, 5], [6, 7, 8]], [[3, 1, 2], [0, 4, 5], [6, 7, 8]], [[0, 1, 2], [3, 4, 5], [6, 7, 8]]]};
            const steps = DATA.steps || [DATA.initial];
            let idx = 0;
            const boardEl = document.getElementById("board");
            const statusEl = document.getElementById("status");
            const stepsListEl = document.getElementById("stepsList");

            // create the 3x3 board
            function renderBoard(state) {
                // empty board
                boardEl.innerHTML = "";
                // transform from 2D array to 1D
                // a-->1D array im building
                // b--> each row in the 2D array i already have
                const flat = state.reduce((a, b) => a.concat(b), []);
                for (let i = 0; i < 9; i++) {
                    const v = flat[i];
                    const d = document.createElement("div");
                    d.className = "tile" + (v === 0 ? " zero" : "");
                    d.textContent = v === 0 ? "" : v;
                    boardEl.appendChild(d);
                }
            }

            // showing the step you wanna see
            function show(i) {
                // steps between: 0 and steps.length-1
                idx = Math.max(0, Math.min(i, steps.length - 1));
                renderBoard(steps[idx]);
                // step kam / out of kam total
                statusEl.textContent = `Step ${idx + 1} / ${steps.length}`;
                // frame the step you're currently in
                //create an array from the children of stepsListEl(all the steps)
                Array.from(stepsListEl.children).forEach(
                    //loop for each child in stepsListEl(each step)
                    //c--> each child
                    //ii-->index of each child
                    (c, ii) =>
                        (c.style.outline =
                            ii === idx
                                ? "2px solid rgba(96,165,250,0.12)"
                                : "none")
                );
            }

            document
                .getElementById("prev")
                .addEventListener("click", () => show(idx - 1));
            document
                .getElementById("next")
                .addEventListener("click", () => show(idx + 1));
            let playing = false,
                timer = null;
            document.getElementById("play").addEventListener("click", () => {
                // if currently playing,stop playing when we click on Pause
                if (playing) {
                    clearInterval(timer);
                    playing = false;
                    document.getElementById("play").textContent = "Play";
                    return;
                }
                playing = true;
                document.getElementById("play").textContent = "Pause";
                //timer:700-->change every move every 0.7sec
                timer = setInterval(() => {
                    if (idx < steps.length - 1) show(idx + 1);
                    // if reached the end,stop playing
                    else {
                        clearInterval(timer);
                        playing = false;
                        document.getElementById("play").textContent = "Play";
                    }
                }, 700);
            });

            // creating the step child in the stepsListEl
            steps.forEach((s, i) => {
                const thumb = document.createElement("div");
                thumb.className = "step-thumb";
                const flat = s.reduce((a, b) => a.concat(b), []);
                flat.forEach((v) => {
                    const t = document.createElement("div");
                    t.style.padding = "8px";
                    t.style.textAlign = "center";
                    t.style.fontWeight = "600";
                    t.textContent = v === 0 ? "" : v;
                    thumb.appendChild(t);
                });
                thumb.addEventListener("click", () => show(i));
                stepsListEl.appendChild(thumb);
            });
            //showing the first step(the initial step)
            show(0);
        </script>
    </body>
</html>
