<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>BFS 8-Puzzle Viewer</title>
        <style>
            :root {
                --bg: #0b1020;
                --card: #0f1724;
                --accent: #60a5fa;
                --muted: #9aa8bf;
            }
            body {
                margin: 0;
                background: linear-gradient(180deg, var(--bg), #061021);
                font-family: Inter, Segoe UI, Roboto, Arial;
                color: #e6eef8;
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
            }
            .wrap {
                width: 100%;
                max-width: 1000px;
                padding: 24px;
            }
            .top {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 16px;
            }
            .card {
                background: rgba(255, 255, 255, 0.02);
                border: 1px solid rgba(255, 255, 255, 0.04);
                padding: 18px;
                border-radius: 12px;
            }
            .board {
                width: 360px;
                height: 360px;
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            .tile {
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(180deg, #0f2238, #0b1b2e);
                border-radius: 10px;
                font-size: 32px;
                font-weight: 700;
                color: #dff7ee;
            }
            .tile.zero {
                background: transparent;
                border: 2px dashed rgba(255, 255, 255, 0.04);
                color: var(--muted);
                font-weight: 600;
            }
            .controls {
                display: flex;
                gap: 8px;
                margin-bottom: 12px;
            }
            button {
                padding: 10px 14px;
                border-radius: 8px;
                border: 1px solid rgba(255, 255, 255, 0.06);
                background: transparent;
                color: inherit;
                cursor: pointer;
            }
            button.primary {
                background: linear-gradient(90deg, var(--accent), #34d399);
                border: none;
                color: #022;
            }
            .steps-list {
                display: flex;
                flex-direction: column;
                gap: 8px;
                margin-left: 16px;
            }
            .step-thumb {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
                padding: 6px;
                border-radius: 8px;
                background: rgba(255, 255, 255, 0.01);
                cursor: pointer;
            }
            .layout {
                display: flex;
            }
            @media (max-width: 900px) {
                .layout {
                    flex-direction: column;
                }
                .steps-list {
                    margin-left: 0;
                    margin-top: 12px;
                }
            }
        </style>
    </head>
    <body>
        <div class="wrap">
            <div class="top">
                <div>
                    <h1 style="margin: 0">BFS 8-Puzzle Viewer</h1>
                    <div style="color: var(--muted); font-size: 13px">
                        Use the controls to step through the BFS solution
                    </div>
                </div>
                <div style="color: var(--muted)">Generated by index.py</div>
            </div>

            <div class="layout">
                <div class="card">
                    <div class="controls">
                        <button id="prev">◀ Prev</button>
                        <button id="next">Next ▶</button>
                        <button id="play" class="primary">Play</button>
                        <div style="flex: 1"></div>
                        <div id="status" style="color: var(--muted)"></div>
                    </div>
                    <div id="board" class="board"></div>
                </div>

                <div class="steps-list card" id="stepsList"></div>
            </div>
        </div>

        <script>
            // DATA placeholder will be replaced by index.py
            const DATA = { data };
            const steps = DATA.steps || [DATA.initial];
            let idx = 0;
            const boardEl = document.getElementById("board");
            const statusEl = document.getElementById("status");
            const stepsListEl = document.getElementById("stepsList");

            function renderBoard(state) {
                boardEl.innerHTML = "";
                const flat = state.reduce((a, b) => a.concat(b), []);
                for (let i = 0; i < 9; i++) {
                    const v = flat[i];
                    const d = document.createElement("div");
                    d.className = "tile" + (v === 0 ? " zero" : "");
                    d.textContent = v === 0 ? "" : v;
                    boardEl.appendChild(d);
                }
            }

            function show(i) {
                idx = Math.max(0, Math.min(i, steps.length - 1));
                renderBoard(steps[idx]);
                statusEl.textContent = `Step ${idx + 1} / ${steps.length}`;
                // highlight
                Array.from(stepsListEl.children).forEach(
                    (c, ii) =>
                        (c.style.outline =
                            ii === idx
                                ? "2px solid rgba(96,165,250,0.12)"
                                : "none")
                );
            }

            document
                .getElementById("prev")
                .addEventListener("click", () => show(idx - 1));
            document
                .getElementById("next")
                .addEventListener("click", () => show(idx + 1));
            let playing = false,
                timer = null;
            document.getElementById("play").addEventListener("click", () => {
                if (playing) {
                    clearInterval(timer);
                    playing = false;
                    document.getElementById("play").textContent = "Play";
                    return;
                }
                playing = true;
                document.getElementById("play").textContent = "Pause";
                timer = setInterval(() => {
                    if (idx < steps.length - 1) show(idx + 1);
                    else {
                        clearInterval(timer);
                        playing = false;
                        document.getElementById("play").textContent = "Play";
                    }
                }, 700);
            });

            // thumbnails
            steps.forEach((s, i) => {
                const thumb = document.createElement("div");
                thumb.className = "step-thumb";
                const flat = s.reduce((a, b) => a.concat(b), []);
                flat.forEach((v) => {
                    const t = document.createElement("div");
                    t.style.padding = "8px";
                    t.style.textAlign = "center";
                    t.style.fontWeight = "600";
                    t.textContent = v === 0 ? "" : v;
                    thumb.appendChild(t);
                });
                thumb.addEventListener("click", () => show(i));
                stepsListEl.appendChild(thumb);
            });

            show(0);
        </script>
    </body>
</html>
